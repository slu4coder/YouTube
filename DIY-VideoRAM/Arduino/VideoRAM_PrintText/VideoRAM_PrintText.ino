byte charset[8][128] = {   // charset line data
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x66,0x66,0x18,0x62,0x3c,0x06,0x0c,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x18,0x3c,0x3c,0x06,0x7e,0x3c,0x7e,0x3c,0x3c,0x00,0x00,0x0e,0x00,0x70,0x3c,0x3c,0x18,0x7c,0x3c,0x78,0x7e,0x7e,0x3c,0x66,0x3c,0x1e,0x66,0x60,0x63,0x66,0x3c,0x7c,0x3c,0x7c,0x3c,0x7e,0x66,0x66,0x63,0x66,0x66,0x7e,0x3c,0x00,0x3c,0x00,0x00,0x3c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0e,0x18,0x70,0x00,0xff,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x66,0x66,0x3e,0x66,0x66,0x0c,0x18,0x18,0x66,0x18,0x00,0x00,0x00,0x03,0x66,0x18,0x66,0x66,0x0e,0x60,0x66,0x66,0x66,0x66,0x00,0x00,0x18,0x00,0x18,0x66,0x66,0x3c,0x66,0x66,0x6c,0x60,0x60,0x66,0x66,0x18,0x0c,0x6c,0x60,0x77,0x76,0x66,0x66,0x66,0x66,0x66,0x18,0x66,0x66,0x63,0x66,0x66,0x06,0x30,0x60,0x0c,0x18,0x00,0x66,0x00,0x60,0x00,0x06,0x00,0x0e,0x00,0x60,0x18,0x06,0x60,0x38,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x18,0x00,0xff,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x66,0xff,0x60,0x0c,0x3c,0x18,0x30,0x0c,0x3c,0x18,0x00,0x00,0x00,0x06,0x6e,0x38,0x06,0x06,0x1e,0x7c,0x60,0x0c,0x66,0x66,0x18,0x18,0x30,0x7e,0x0c,0x06,0x6e,0x66,0x66,0x60,0x66,0x60,0x60,0x60,0x66,0x18,0x0c,0x78,0x60,0x7f,0x7e,0x66,0x66,0x66,0x66,0x60,0x18,0x66,0x66,0x63,0x3c,0x66,0x0c,0x30,0x30,0x0c,0x3c,0x00,0x6e,0x3c,0x60,0x3c,0x06,0x3c,0x18,0x3e,0x60,0x00,0x00,0x60,0x18,0x66,0x7c,0x3c,0x7c,0x3e,0x7c,0x3e,0x7e,0x66,0x66,0x63,0x66,0x66,0x7e,0x18,0x18,0x18,0x00,0xff,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x00,0x66,0x3c,0x18,0x38,0x00,0x30,0x0c,0xff,0x7e,0x00,0x7e,0x00,0x0c,0x76,0x18,0x0c,0x1c,0x66,0x06,0x7c,0x18,0x3c,0x3e,0x00,0x00,0x60,0x00,0x06,0x0c,0x6e,0x7e,0x7c,0x60,0x66,0x78,0x78,0x6e,0x7e,0x18,0x0c,0x70,0x60,0x6b,0x7e,0x66,0x7c,0x66,0x7c,0x3c,0x18,0x66,0x66,0x6b,0x18,0x3c,0x18,0x30,0x18,0x0c,0x7e,0x00,0x6e,0x06,0x7c,0x60,0x3e,0x66,0x3e,0x66,0x7c,0x38,0x06,0x6c,0x18,0x7f,0x66,0x66,0x66,0x66,0x66,0x60,0x18,0x66,0x66,0x6b,0x3c,0x66,0x0c,0x70,0x18,0x0e,0x3b,0xff,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x06,0x30,0x67,0x00,0x30,0x0c,0x3c,0x18,0x00,0x00,0x00,0x18,0x66,0x18,0x30,0x06,0x7f,0x06,0x66,0x18,0x66,0x06,0x00,0x00,0x30,0x7e,0x0c,0x18,0x60,0x66,0x66,0x60,0x66,0x60,0x60,0x66,0x66,0x18,0x0c,0x78,0x60,0x63,0x6e,0x66,0x60,0x66,0x78,0x06,0x18,0x66,0x66,0x7f,0x3c,0x18,0x30,0x30,0x0c,0x0c,0x18,0x00,0x60,0x3e,0x66,0x60,0x66,0x7e,0x18,0x66,0x66,0x18,0x06,0x78,0x18,0x7f,0x66,0x66,0x66,0x66,0x60,0x3c,0x18,0x66,0x66,0x7f,0x18,0x66,0x18,0x18,0x18,0x18,0x6e,0xff,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x66,0x7c,0x66,0x66,0x00,0x18,0x18,0x66,0x18,0x18,0x00,0x18,0x30,0x66,0x18,0x60,0x66,0x06,0x66,0x66,0x18,0x66,0x66,0x18,0x18,0x18,0x00,0x18,0x00,0x66,0x66,0x66,0x66,0x6c,0x60,0x60,0x66,0x66,0x18,0x6c,0x6c,0x60,0x63,0x66,0x66,0x60,0x3c,0x6c,0x66,0x18,0x66,0x3c,0x77,0x66,0x18,0x60,0x30,0x06,0x0c,0x18,0x00,0x66,0x66,0x66,0x60,0x66,0x60,0x18,0x3e,0x66,0x18,0x06,0x6c,0x18,0x6b,0x66,0x66,0x7c,0x3e,0x60,0x06,0x18,0x66,0x3c,0x3e,0x3c,0x3e,0x30,0x18,0x18,0x18,0x00,0xff,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x00,0x66,0x18,0x46,0x3f,0x00,0x0c,0x30,0x00,0x00,0x18,0x00,0x18,0x60,0x3c,0x7e,0x7e,0x3c,0x06,0x3c,0x3c,0x18,0x3c,0x3c,0x00,0x18,0x0e,0x00,0x70,0x18,0x3c,0x66,0x7c,0x3c,0x78,0x7e,0x60,0x3c,0x66,0x3c,0x38,0x66,0x7e,0x63,0x66,0x3c,0x60,0x0e,0x66,0x3c,0x18,0x3c,0x18,0x63,0x66,0x18,0x7e,0x3c,0x03,0x3c,0x18,0x00,0x3c,0x3e,0x7c,0x3c,0x3e,0x3c,0x18,0x06,0x66,0x3c,0x06,0x66,0x3c,0x63,0x66,0x3c,0x60,0x06,0x60,0x7c,0x0e,0x3e,0x18,0x36,0x66,0x0c,0x7e,0x0e,0x18,0x70,0x00,0xff,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7c,0x00,0x00,0x3c,0x00,0x00,0x00,0x00,0x00,0x60,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x78,0x00,0x00,0x18,0x00,0x00,0xff,
};

void setup()
{
  DDRD = 0b00011100;  // set D2-4 to output
  for(int i=0; i<16384; i++) WriteByte(0, i);
}

void loop()
{
  Text(15, 15, "Hello, World!!!");
}

void Text(byte x, byte y, String str)
{
  for(int i=0; i<str.length(); i++)
  {
    for(byte j=0; j<8; j++)
    {
      byte c = charset[j][str[i]];
      int adr = ((16 + (y<<3) + j)<<6) + (12 + x + i);
      WriteByte(c, adr);
    }
  }
}

void WriteByte(byte d, long a)
{
  a = (a<<8) + d;
  for(byte i=0; i<24; i++)
  {
    bitWrite(PORTD, 2, a&1);
    a = a>>1;
    bitWrite(PORTD, 3, HIGH); bitWrite(PORTD, 3, LOW);
  }
  bitWrite(PORTD, 4, HIGH); bitWrite(PORTD, 4, LOW);
}
